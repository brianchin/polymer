<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<script>

  /**
   * Support `extends` property (for type-extension only).
   *
   * If the mixin is String-valued, the corresponding Polymer module
   * is mixed in.
   *
   *     Polymer({
   *       is: 'pro-input',
   *       extends: 'input',
   *       ...
   *     });
   *
   * Type-extension objects are created using `is` notation in HTML, or via
   * the secondary argument to `document.createElement` (the type-extension
   * rules are part of the Custom Elements specification, not something
   * created by Polymer).
   *
   * Example:
   *
   *     <!-- right: creates a pro-input element -->
   *     <input is="pro-input">
   *
   *     <!-- wrong: creates an unknown element -->
   *     <pro-input>
   *
   *     <script>
   *        // right: creates a pro-input element
   *        var elt = document.createElement('input', 'pro-input');
   *
   *        // wrong: creates an unknown element
   *        var elt = document.createElement('pro-input');
   *     <\script>
   *
   *   @class base feature: extends
   */

  Polymer.Base._addFeature({

    _getExtendedPrototype: function(tag, ns) {
      return this._getExtendedNativePrototype(tag, ns);
    },

    _nativePrototypes: {}, // static

    _getNativePrototypesForNamespace: function(ns) {
      ns = ns || "http://www.w3.org/1999/xhtml";

      var prototypes = this._nativePrototypes[ns];

      if (!prototypes) {
        prototypes = {};
        this._nativePrototypes[ns] = prototypes;
      }

      return prototypes;
    },

    _getExtendedNativePrototype: function(tag, ns) {
      var p = this._getNativePrototypesForNamespace(ns)[tag];
      if (!p) {
        var np = this.getNativePrototype(tag, ns);
        p = this.extend(Object.create(np), Polymer.Base);
        this._getNativePrototypesForNamespace(ns)[tag] = p;
      }
      return p;
    },

    /**
     * Returns the native element prototype for the tag specified.
     *
     * @method getNativePrototype
     * @param {string} tag  HTML tag name.
     * @return {Object} Native prototype for specified tag.
    */
    getNativePrototype: function(tag, ns) {
      // TODO(sjmiles): sad necessity
      ns = ns || "http://www.w3.org/1999/xhtml";
      return Object.getPrototypeOf(document.createElementNS(ns, tag));
    }

  });

</script>
